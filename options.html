<!--
Copyright (c) 2025 Bastian Kleinschmidt
Licensed under the GNU Affero General Public License v3.0.
See LICENSE.txt for details.
-->
<!doctype html>
<meta charset="utf-8">
<title data-i18n="options_title">Nextcloud Talk - Einstellungen</title>
<style>
:root{
  --brand-blue:#0082C9;
  --header-height:48px;
  --control-height:38px;
  --control-radius:10px;
  --control-padding-x:12px;
  --content-max:760px;
}
body{
  font:14px 'Segoe UI Variable','Segoe UI','Calibri','Trebuchet MS',sans-serif;
  max-width:var(--content-max);
  margin:20px auto;
  line-height:1.45;
  background:radial-gradient(120% 140% at 50% -20%,#ffffff 0%,#f3f6ff 55%,#e9effb 100%);
  color:#1f1f1f;
}

.hero{border-radius:12px; margin-bottom:18px; display:flex; justify-content:center; align-items:center; overflow:hidden; height:var(--header-height); background:var(--brand-blue);}
.hero img{width:auto; height:100%; max-width:328px; display:block; object-fit:contain;}
.tabs{border:1px solid #d7d7d7; border-radius:12px; overflow:hidden; box-shadow:0 18px 36px rgba(11,17,39,0.12); background:#fff; --tab-panel-min-height:auto;}
.tab-list{display:flex; flex-wrap:wrap; border-bottom:1px solid #e1e1e1; background:#f7f8fa;}
.tab-list button{flex:1 1 120px; padding:10px; border:none; background:none; cursor:pointer; font-weight:600;}
.tab-list button.active{background:#ffffff; border-bottom:3px solid var(--brand-blue);}
.tab-panel{display:none; padding:20px; min-height:var(--tab-panel-min-height); will-change:transform,opacity;}
.tab-panel.active{display:block; animation:tabEnterForward .22s ease-out;}
.tabs[data-nav="back"] .tab-panel.active{animation-name:tabEnterBack;}
@keyframes tabEnterForward{
  from{opacity:0; transform:translateX(14px);}
  to{opacity:1; transform:translateX(0);}
}
@keyframes tabEnterBack{
  from{opacity:0; transform:translateX(-14px);}
  to{opacity:1; transform:translateX(0);}
}
@media (prefers-reduced-motion: reduce){
  .tab-panel.active{animation:none;}
}
.row{display:grid; grid-template-columns: 220px minmax(240px, 420px); gap:10px; align-items:start; margin:10px 0;}
.row.row-inset{padding:0 14px;}
.row > div{max-width:420px; width:100%;}
.field-stack{display:flex; flex-direction:column; gap:6px; max-width:420px; width:100%;}
input[type="url"], input[type="text"], input[type="password"], select{
  height:var(--control-height);
  padding:0 var(--control-padding-x);
  border:1px solid #ccc;
  border-radius:var(--control-radius);
  width:100%;
  box-sizing:border-box;
  background:#fff;
}
footer{display:flex; gap:8px; margin-top:16px}
#status{opacity:.8; font-size:12px}
.donation{display:flex; flex-direction:column; gap:8px; margin-top:12px;}
.donation-link{display:inline-flex; align-items:center; gap:10px; padding:8px 10px; border:1px solid #e0e0e0; border-radius:8px; text-decoration:none; color:inherit; background:#fafafa;}
.donation-link:hover{background:#f0f7ff; border-color:var(--brand-blue);}
.donation-link img{width:24px; height:24px;}
.about-list{list-style:none; padding-left:0; margin:0;}
.about-list li{margin-bottom:6px;}
.tabs h2{margin-top:0;}
.auth-block{border:1px solid #d5d5d5; border-radius:8px; padding:14px; margin:14px 0;}
.auth-block legend{font-weight:600; padding:0 4px;}
.radio-option{display:flex; align-items:center; gap:8px; margin:6px 0;}
.button-row{display:flex; flex-wrap:wrap; gap:10px; margin-top:12px;}
#testConnection,#loginFlowButton{
  height:var(--control-height);
  padding:0 14px;
  border-radius:var(--control-radius);
  border:1px solid #c7c7c7;
  background:#f5f5f5;
}
#save{
  height:var(--control-height);
  padding:0 16px;
  background:var(--brand-blue);
  border:1px solid var(--brand-blue);
  color:#fff;
  border-radius:var(--control-radius);
}
.checklist{display:flex; flex-direction:column; gap:6px;}
.checklist label{font-weight:400;}
.hint{margin:6px 0 0 0; font-size:12px; color:#555;}
</style>
<h1 data-i18n="options_heading">Nextcloud Talk - Einstellungen</h1>
<div class="hero">
  <img src="ui/assets/header-solid-blue-328x96.png" alt="NC Connector">
</div>
<div class="tabs">
  <div class="tab-list" role="tablist">
    <button type="button" class="tab-btn active" data-tab="general" data-i18n="options_tab_general">Allgemein</button>
    <button type="button" class="tab-btn" data-tab="sharing" data-i18n="options_tab_sharing">Sharing</button>
    <button type="button" class="tab-btn" data-tab="talklink" data-i18n="options_tab_talklink">Talk Link</button>
    <button type="button" class="tab-btn" data-tab="advanced" data-i18n="options_tab_advanced">Erweitert</button>
    <button type="button" class="tab-btn" data-tab="debug" data-i18n="options_tab_debug">Debug</button>
    <button type="button" class="tab-btn" data-tab="about" data-i18n="options_tab_about">Über</button>
  </div>
  <section id="tab-general" class="tab-panel active">
    <div class="row"><label for="baseUrl" data-i18n="options_base_url_label">Nextcloud URL</label><input id="baseUrl" type="url" data-i18n-placeholder="options_base_url_placeholder" placeholder="https://cloud.example.com"></div>
    <fieldset class="auth-block">
      <legend data-i18n="options_auth_heading">Authentifizierung</legend>
      <label class="radio-option">
        <input type="radio" name="authMode" id="authModeManual" value="manual" checked>
        <span data-i18n="options_auth_manual">Manuell (Benutzername + App-Passwort eingeben)</span>
      </label>
      <label class="radio-option">
        <input type="radio" name="authMode" id="authModeLogin" value="loginFlow">
        <span data-i18n="options_auth_login">Login mit Nextcloud (App-Passwort automatisch holen)</span>
      </label>
      <div class="button-row">
        <button id="loginFlowButton" type="button" data-i18n="options_loginflow_button">Login mit Nextcloud...</button>
        <button id="testConnection" type="button" data-i18n="options_test_button">Verbindung testen</button>
      </div>
    </fieldset>
    <div class="row"><label for="user" data-i18n="options_user_label">Benutzername</label><input id="user" type="text"></div>
    <div class="row"><label for="appPass" data-i18n="options_app_pass_label">App-Passwort</label><input id="appPass" type="password"></div>
  </section>
  <section id="tab-sharing" class="tab-panel">
    <div class="row row-inset">
      <label for="sharingBase" data-i18n="options_sharing_base_label">Basisverzeichnis</label>
      <div class="field-stack">
        <input id="sharingBase" type="text">
        <p class="hint" data-i18n="options_sharing_base_hint">Dateien werden unterhalb dieses Verzeichnisses abgelegt (z.B. "90 Freigaben - extern").</p>
      </div>
    </div>
    <fieldset class="auth-block">
      <legend data-i18n="options_sharing_defaults_heading">Default-Einstellungen</legend>
      <div class="row">
        <label for="sharingDefaultShareName" data-i18n="options_sharing_default_share_name_label">Freigabename</label>
        <div class="field-stack">
          <input id="sharingDefaultShareName" type="text">
        </div>
      </div>
      <div class="row">
        <label data-i18n="options_sharing_default_permissions_label">Standard-Berechtigungen</label>
        <div class="checklist">
          <label><input id="sharingDefaultPermCreate" type="checkbox"> <span data-i18n="options_sharing_default_perm_create">Hochladen/Erstellen</span></label>
          <label><input id="sharingDefaultPermWrite" type="checkbox"> <span data-i18n="options_sharing_default_perm_write">Bearbeiten</span></label>
          <label><input id="sharingDefaultPermDelete" type="checkbox"> <span data-i18n="options_sharing_default_perm_delete">Löschen</span></label>
        </div>
      </div>
      <div class="row">
        <label for="sharingDefaultPassword" data-i18n="options_sharing_default_password_label">Passwort setzen</label>
        <input id="sharingDefaultPassword" type="checkbox">
      </div>
      <div class="row">
        <label for="sharingDefaultExpireDays" data-i18n="options_sharing_default_expire_days_label">Ablaufdatum (Tage)</label>
        <input id="sharingDefaultExpireDays" type="number" min="1" step="1">
      </div>
    </fieldset>
  </section>
  <section id="tab-talklink" class="tab-panel">
    <fieldset class="auth-block">
      <legend data-i18n="options_talk_defaults_heading">Default-Einstellungen</legend>
      <div class="row">
        <label for="talkDefaultTitle" data-i18n="options_talk_default_title_label">Titel</label>
        <input id="talkDefaultTitle" type="text">
      </div>
      <div class="row">
        <label for="talkDefaultLobby" data-i18n="options_talk_default_lobby_label">Lobby bis Startzeit aktiv</label>
        <input id="talkDefaultLobby" type="checkbox">
      </div>
      <div class="row">
        <label for="talkDefaultListable" data-i18n="options_talk_default_listable_label">In Suche anzeigen</label>
        <input id="talkDefaultListable" type="checkbox">
      </div>
      <div class="row">
        <label for="talkDefaultAddParticipants" data-i18n="options_talk_default_add_participants_label">Teilnehmer in den Raum hinzufügen</label>
        <input id="talkDefaultAddParticipants" type="checkbox">
      </div>
      <div class="row">
        <label for="talkDefaultPassword" data-i18n="options_talk_default_password_label">Passwort setzen</label>
        <input id="talkDefaultPassword" type="checkbox">
      </div>
      <div class="row">
        <label data-i18n="options_talk_default_roomtype_label">Raumtyp</label>
        <div class="checklist">
          <label><input type="radio" name="talkDefaultRoomType" value="event"> <span data-i18n="options_talk_default_roomtype_event">Event-Konversation</span></label>
          <label><input type="radio" name="talkDefaultRoomType" value="normal"> <span data-i18n="options_talk_default_roomtype_standard">Standard-Raum</span></label>
        </div>
      </div>
    </fieldset>
  </section>
  <section id="tab-advanced" class="tab-panel">
    <fieldset class="auth-block">
      <legend data-i18n="options_advanced_language_heading">Spracheinstellungen</legend>
      <div class="row">
        <label for="shareBlockLang" data-i18n="options_share_block_lang_label">Sprache im Freigabe-Block</label>
        <div>
          <select id="shareBlockLang">
            <option value="default" data-i18n="options_lang_default">Standard (UI)</option>
            <option value="en" data-i18n="options_lang_en">English</option>
            <option value="de" data-i18n="options_lang_de">Deutsch</option>
            <option value="fr" data-i18n="options_lang_fr">Français</option>
          </select>
          <p class="hint" data-i18n="options_share_block_lang_hint">Steuert die Sprache des eingefügten Freigabe-HTML-Blocks.</p>
        </div>
      </div>
      <div class="row">
        <label for="eventDescriptionLang" data-i18n="options_event_description_lang_label">Sprache im Talk-Beschreibungstext</label>
        <div>
          <select id="eventDescriptionLang">
            <option value="default" data-i18n="options_lang_default">Standard (UI)</option>
            <option value="en" data-i18n="options_lang_en">English</option>
            <option value="de" data-i18n="options_lang_de">Deutsch</option>
            <option value="fr" data-i18n="options_lang_fr">Français</option>
          </select>
          <p class="hint" data-i18n="options_event_description_lang_hint">Steuert die Sprache des Talk-Textblocks in Terminen.</p>
        </div>
      </div>
    </fieldset>
  </section>
  <section id="tab-debug" class="tab-panel">
    <div class="row">
      <label data-i18n="options_debug_label">Debug-Logging</label>
      <label style="display:flex; align-items:center; gap:6px;">
        <input id="debugEnabled" type="checkbox">
        <span data-i18n="options_debug_hint">Konsole für Diagnosemeldungen verwenden</span>
      </label>
    </div>
  </section>
  <section id="tab-about" class="tab-panel">
    <ul class="about-list">
      <li><strong data-i18n="options_about_version_label">Version:</strong> <span id="aboutVersion">–</span></li>
      <li><strong data-i18n="options_about_copyright_label">Copyright:</strong> <span>2025 Bastian Kleinschmidt</span></li>
      <li><strong data-i18n="options_about_license_label">Lizenz:</strong> <a id="licenseLink" href="LICENSE.txt" target="_blank" rel="noopener" data-i18n="options_about_license_value">AGPL v3</a></li>
    </ul>
    <div class="donation">
      <strong data-i18n="options_about_support_heading">Unterstützen</strong>
      <a class="donation-link" href="https://paypal.me/debaschdi" target="_blank" rel="noopener">
        <img src="icons/paypal.svg" alt="">
        <span data-i18n="options_support_link">PayPal: paypal.me/debaschdi</span>
      </a>
    </div>
  </section>
</div>
<footer>
  <button id="save" data-i18n="options_save_button">Speichern</button>
  <span id="status"></span>
</footer>
<script src="modules/i18n.js"></script>
<script src="modules/sharingStorage.js"></script>
<script src="modules/hostPermissions.js"></script>
<script src="modules/ocs.js"></script>
<script src="ui/textUtils.js"></script>
<script src="modules/ncSharing.js"></script>
<script src="ui/domI18n.js"></script>
<script src="options.js"></script>













